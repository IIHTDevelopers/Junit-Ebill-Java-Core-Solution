<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TestUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">inventory-management-app</a> &gt; <a href="index.source.html" class="el_package">mainapp.testutils</a> &gt; <span class="el_source">TestUtils.java</span></div><h1>TestUtils.java</h1><pre class="source lang-java linenums">package mainapp.testutils;

import java.io.BufferedReader;
import java.io.File;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.HashMap;
import java.util.Map;
import java.util.stream.Stream;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;

// boiler-plate code

<span class="nc" id="L23">public class TestUtils {</span>

	public static final String TEXT_RESET = &quot;\033[0m&quot;;
	public static final String RED_BOLD_BRIGHT = &quot;\033[1;91m&quot;; // RED
	public static final String GREEN_BOLD_BRIGHT = &quot;\033[1;92m&quot;; // GREEN
	public static final String YELLOW_BOLD_BRIGHT = &quot;\033[1;93m&quot;;// YELLOW
	public static final String BLUE_BOLD_BRIGHT = &quot;\033[1;94m&quot;; // BLUE

	public static String testResult;

	public static int total;
	public static int passed;
	public static int failed;

	public static File businessTestFile;
	public static File boundaryTestFile;
	public static File exceptionTestFile;
	public static File xmlFile;

	public static final String GUID = &quot;6ed39465-d6d3-4ec4-b27d-1dcb870b2992&quot;;
	public static String customData;
	public static final String URL = &quot;https://yaksha-prod-sbfn.azurewebsites.net/api/YakshaMFAEnqueue?code=jSTWTxtQ8kZgQ5FC0oLgoSgZG7UoU9Asnmxgp6hLLvYId/GW9ccoLw==&quot;;
	static {
<span class="nc" id="L46">		total = 0;</span>
<span class="nc" id="L47">		passed = 0;</span>
<span class="nc" id="L48">		failed = 0;</span>

<span class="nc" id="L50">		testResult = &quot;&quot;;</span>


<span class="nc" id="L53">		businessTestFile = new File(&quot;./output_revised.txt&quot;);</span>
<span class="nc" id="L54">		businessTestFile.delete();</span>

<span class="nc" id="L56">		boundaryTestFile = new File(&quot;./output_boundary_revised.txt&quot;);</span>
<span class="nc" id="L57">		boundaryTestFile.delete();</span>

<span class="nc" id="L59">		exceptionTestFile = new File(&quot;./output_exception_revised.txt&quot;);</span>
<span class="nc" id="L60">		exceptionTestFile.delete();</span>
<span class="nc" id="L61">	}</span>

	private static String readData(String filePath) {
<span class="nc" id="L64">		StringBuilder contentBuilder = new StringBuilder();</span>

<span class="nc" id="L66">		try (Stream&lt;String&gt; stream = Files.lines(Paths.get(filePath), StandardCharsets.UTF_8)) {</span>
<span class="nc" id="L67">			stream.forEach(s -&gt; contentBuilder.append(s).append(&quot;\n&quot;));</span>
<span class="nc" id="L68">		} catch (IOException e) {</span>
<span class="nc" id="L69">			e.printStackTrace();</span>
<span class="nc" id="L70">			System.out.println(e.getMessage());</span>
<span class="nc" id="L71">		}</span>

<span class="nc" id="L73">		return contentBuilder.toString();</span>
	}

	public static void yakshaAssert(String testName, Object result, File file) throws IOException {
<span class="nc" id="L77">		TestResults testResults = new TestResults();</span>
<span class="nc" id="L78">		Map&lt;String, TestCaseResultDto&gt; testCaseResults = new HashMap&lt;String, TestCaseResultDto&gt;();</span>

<span class="nc" id="L80">		customData = readData(&quot;../custom.ih&quot;);</span>
<span class="nc" id="L81">		String resultStatus = &quot;Failed&quot;;</span>
<span class="nc" id="L82">		int resultScore = 0;</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">		if (result.toString().equals(&quot;true&quot;)) {</span>
<span class="nc" id="L84">			resultScore = 1;</span>
<span class="nc" id="L85">			resultStatus = &quot;Passed&quot;;</span>
		}
		try {
<span class="nc" id="L88">			String testType = &quot;functional&quot;;</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">			if (file.getName().contains(&quot;boundary&quot;))</span>
<span class="nc" id="L90">				testType = &quot;boundary&quot;;</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">			if (file.getName().contains(&quot;exception&quot;))</span>
<span class="nc" id="L92">				testType = &quot;exception&quot;;</span>
<span class="nc" id="L93">			testCaseResults.put(GUID,</span>
<span class="nc" id="L94">					new TestCaseResultDto(testName, testType, 1, resultScore, resultStatus, true, &quot;&quot;));</span>
<span class="nc" id="L95">		} catch (Exception e) {</span>
			
<span class="nc" id="L97">			e.printStackTrace();</span>
<span class="nc" id="L98">			System.out.println(e.getMessage());</span>
<span class="nc" id="L99">		}</span>
<span class="nc" id="L100">		testResults.setTestCaseResults(asJsonString(testCaseResults));</span>
<span class="nc" id="L101">		testResults.setCustomData(customData);</span>

		
try {

<span class="nc" id="L106">	URL url = new URL(URL);</span>
<span class="nc" id="L107">	HttpURLConnection conn = (HttpURLConnection) url.openConnection();</span>
<span class="nc" id="L108">	conn.setDoOutput(true);</span>
<span class="nc" id="L109">	conn.setRequestMethod(&quot;POST&quot;);</span>
<span class="nc" id="L110">	conn.setRequestProperty(&quot;Content-Type&quot;, &quot;application/json&quot;);</span>

//	String input = &quot;{\&quot;qty\&quot;:100,\&quot;name\&quot;:\&quot;iPad 4\&quot;}&quot;;
<span class="nc" id="L113">	String input = asJsonString(testResults);</span>
<span class="nc" id="L114">	OutputStream os = conn.getOutputStream();</span>
<span class="nc" id="L115">	os.write(input.getBytes());</span>
<span class="nc" id="L116">	os.flush();</span>

	
<span class="nc" id="L119">	BufferedReader br = new BufferedReader(new InputStreamReader(</span>
<span class="nc" id="L120">			(conn.getInputStream())));</span>

	String output;
<span class="nc bnc" id="L123" title="All 2 branches missed.">	while ((output = br.readLine()) != null) {</span>
<span class="nc" id="L124">		System.out.println(output);</span>
	}

<span class="nc" id="L127">	conn.disconnect();</span>

<span class="nc" id="L129">  } catch (MalformedURLException e) {</span>

<span class="nc" id="L131">	e.printStackTrace();</span>

<span class="nc" id="L133">  } catch (IOException e) {</span>

<span class="nc" id="L135">	e.printStackTrace();</span>

<span class="nc" id="L137"> }	</span>


<span class="nc" id="L140">		total++;</span>
<span class="nc" id="L141">		String[] r = testName.split(&quot;(?=\\p{Upper})&quot;);</span>
<span class="nc" id="L142">		System.out.print(&quot;\n&quot; + BLUE_BOLD_BRIGHT + &quot;=&gt;&quot;);</span>
		

<span class="nc" id="L145">		System.out.print(YELLOW_BOLD_BRIGHT + &quot;Test For : &quot;);</span>
		

<span class="nc bnc" id="L148" title="All 2 branches missed.">		for (int i = 1; i &lt; r.length; i++) {</span>
<span class="nc" id="L149">			System.out.print(YELLOW_BOLD_BRIGHT + r[i] + &quot; &quot;);</span>
			
		}
<span class="nc" id="L152">		System.out.print(&quot; : &quot;);</span>
		
<span class="nc bnc" id="L154" title="All 2 branches missed.">		if (result.toString().equals(&quot;true&quot;)) {</span>
<span class="nc" id="L155">			System.out.println(GREEN_BOLD_BRIGHT + &quot;PASSED&quot; + TEXT_RESET);</span>
<span class="nc" id="L156">			passed++;</span>
		} else {
<span class="nc" id="L158">			System.out.println(RED_BOLD_BRIGHT + &quot;FAILED&quot; + TEXT_RESET);</span>
<span class="nc" id="L159">			failed++;</span>
		}
<span class="nc" id="L161">	}</span>

	public static void testReport() {

<span class="nc" id="L165">		 System.out.print(&quot;\n&quot; + BLUE_BOLD_BRIGHT + &quot;TEST CASES EVALUATED : &quot; + total</span>
		 + TEXT_RESET);
<span class="nc" id="L167">		 System.out.print(&quot;\n&quot; + GREEN_BOLD_BRIGHT + &quot;PASSED : &quot; + passed +</span>
		 TEXT_RESET);
<span class="nc" id="L169">		 System.out.println(&quot;\n&quot; + RED_BOLD_BRIGHT + &quot;FAILED : &quot; + failed +</span>
		 TEXT_RESET);

<span class="nc" id="L172">	}</span>

	
	public static String currentTest() {
<span class="nc" id="L176">		return Thread.currentThread().getStackTrace()[2].getMethodName();</span>
	}

	// convert object into JSON
	public static String asJsonString(Object obj) {
<span class="nc" id="L181">		ObjectMapper mapper = new ObjectMapper();</span>
<span class="nc" id="L182">		String jsonString = &quot;&quot;;</span>
		try {
<span class="nc" id="L184">			jsonString = mapper.writeValueAsString(obj);</span>
<span class="nc" id="L185">		} catch (JsonProcessingException e) {</span>
			
<span class="nc" id="L187">			e.printStackTrace();</span>
<span class="nc" id="L188">		}</span>
<span class="nc" id="L189">		return jsonString;</span>

	}

}


</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>